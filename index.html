<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly PE Questions</title>
    
    <!-- Add MathJax script for LaTeX support -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                processEscapes: true
            }
        });
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
            position: relative;
            min-height: 100vh;
            padding-bottom: 60px;
            box-sizing: border-box;
        }
        .weeks {
            max-width: 800px;
            font-family: Arial, sans-serif;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
            position: relative;
            min-height: 100vh;
            box-sizing: border-box;
        }

        h1, h2, h3 {
            color: #ffffff;
            text-align: center;
        }
        .week-container {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .question-container {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #2a2a2a;
            border-radius: 5px;
            border: 1px solid #444;
        }
        .input-group {
            margin-bottom: 10px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #555;
            border-radius: 4px;
            background-color: #333;
            color: #fff;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .result-display {
            margin-top: 15px;
            padding: 10px;
            background-color: #2e3b2f;
            border-radius: 5px;
            display: none;
        }
        .result-value {
            font-weight: bold;
            color: #8bc34a;
        }
        .collapsible-header {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }
        .collapsible-header:after {
            content: "▼";
            font-size: 12px;
            margin-left: 10px;
            transition: transform 0.3s;
        }
        .collapsible-header.collapsed:after {
            content: "▶";
        }
        .collapsible-content {
            transition: max-height 0.3s ease-out;
            overflow: hidden;
            max-height: 2500px;
        }
        .collapsed + .collapsible-content {
            max-height: 0;
        }
        .calculate-btn {
            background-color: #4CAF50;
        }
        .minimize-btn {
            background-color: #2e2e2e;
            margin-left: 10px;
        }
        .formula-display {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #333;
            border-radius: 5px;
        }
        .footer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            max-width: 100%;
            background-color: #1e1e1e;
            color: #e0e0e0;
            text-align: center;
            padding: 15px 0;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.3);
        }
        .footer a {
            color: #4CAF50;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .github-icon {
            font-size: 20px;
            color: #e0e0e0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            background-color: #2a2a2a;
        }
        th, td {
            border: 1px solid #444;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #333;
        }
        .math-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #555;
            border-radius: 4px;
            background-color: #333;
            color: #fff;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="footer">
        <i class="fab fa-github github-icon"></i>
        Made with ❤️ by <a href="https://github.com/oPeras1" target="_blank">oPeras1</a>
    </div>

    <div class="weeks">
        <h1>Weekly PE Questions</h1>
        
        <div id="weeks-container"></div>
        
        <!-- Footer -->

        <script>
            function combinacao(n, k) {
                if (k > n) return 0;
                if (k === 0 || k === n) return 1;
                if (k > n - k) k = n - k;
                let c = 1;
                for (let i = 0; i < k; i++) {
                    c *= (n - i);
                    c /= (i + 1);
                }
                return c;
            }

            function poissonProbability(lambda, k) {
                return (Math.exp(-lambda) * Math.pow(lambda, k)) / factorial(k);
            }

            function factorial(n) {
                return n <= 1 ? 1 : n * factorial(n - 1);
            }

            function normCDF(z) {
                return 0.5 * (1 + erf(z / Math.sqrt(2)));
            }

            function erf(x) {
                const sign = (x >= 0) ? 1 : -1;
                x = Math.abs(x);
                const a1 =  0.254829592;
                const a2 = -0.284496736;
                const a3 =  1.421413741;
                const a4 = -1.453152027;
                const a5 =  1.061405429;
                const p  =  0.3275911;
                const t = 1.0 / (1.0 + p * x);
                const y = 1.0 - (((((a5 * t + a4) * t + a3) * t + a2) * t + a1) * t * Math.exp(-x * x));
                return sign * y;
            }

            const weeks = [
                {
                    name: "Week 1",
                    questions: [
                        {
                            title: "1.",
                            fields: {
                                IeP: "P(I \\cap P)",
                                IenP: "P(I \\cap \\bar{P})"
                            },
                            calculate: (fields) => {
                                const IeP = parseFloat(fields.IeP);
                                const IenP = parseFloat(fields.IenP);
                                return "$P(P|I) = " + (IeP / (IeP + IenP)) + "$";
                            },
                            formula: "P(P|I) = \\frac{P(I \\cap P)}{P(I \\cap P) + P(I \\cap \\bar{P})}"
                        },
                        {
                            title: "2.",
                            fields: {
                                S: "P(S)",
                                AsS: "P(A|S)",
                                AsnS: "P(A|\\bar{S})"
                            },
                            calculate: (fields) => {
                                const S = parseFloat(fields.S);
                                const AsS = parseFloat(fields.AsS);
                                const AsnS = parseFloat(fields.AsnS);
                                return "$P(A) = " + (S*AsS+AsnS*(1-S)) + "$";
                            },
                            formula: "P(A) = P(S) \\cdot P(A|S) + P(A|\\bar{S}) \\cdot (1-P(S))"
                        },
                        {
                            title: "3.",
                            fields: {
                                R: "P(R)",
                                nAsR: "P(\\bar{A}|R)",
                                nAsnR: "P(\\bar{A}|\\bar{R})"
                            },
                            calculate: (fields) => {
                                const R = parseFloat(fields.R);
                                const nAsR = parseFloat(fields.nAsR);
                                const nAsnR = parseFloat(fields.nAsnR);
                                return "$P(R|A) = " + ((R-nAsR*R)/((R-nAsR*R)+((1-R)-nAsnR*(1-R)))) + "$";
                            },
                            formula: "P(R|A) = \\frac{P(R) - P(\\bar{A}|R) \\cdot P(R)}{(P(R) - P(\\bar{A}|R) \\cdot P(R)) + ((1-P(R)) - P(\\bar{A}|\\bar{R}) \\cdot (1-P(R)))}"
                        },
                        {
                            title: "4.",
                            fields: {
                                A: "P(A)",
                                B: "P(B)"
                            },
                            calculate: (fields) => {
                                const A = parseFloat(fields.A);
                                const B = parseFloat(fields.B);
                                const AeB = A*B;
                                const AoB = A+B-AeB;
                                return "$P(A|(A \\cup B)) = " + (A/AoB) + "$";
                            },
                            formula: "P(A|(A \\cup B)) = \\frac{P(A)}{P(A) + P(B) - P(A) \\cdot P(B)}"
                        },
                        {
                            title: "5.",
                            fields: {
                                AsC: "P(A|C)",
                                AeB: "P(A \\cap B)",
                                BeC: "P(B \\cap C)"
                            },
                            calculate: (fields) => {
                                const AsC = parseFloat(fields.AsC);
                                const AeB = parseFloat(fields.AeB);
                                const BeC = parseFloat(fields.BeC);

                                const AeBeC = AsC*BeC
                                
                                return "$P(C|(A \\cap B)) = " + (AeBeC/AeB) + "$";
                            },
                            formula: "P(C|(A \\cap B)) = \\frac{P(A|C) \\cdot P(B \\cap C)}{P(A \\cap B)}"
                        }
                    ]
                },
                {
                    name: "Week 2",
                    questions: [
                        {
                            title: "1.",
                            fields: {
                                G: "P(G)",
                                PG: "k = Bin(|P|, P(G))",
                                P: "|P|"
                            },
                            calculate: (fields) => {
                                const P = parseFloat(fields.P);
                                const G = parseFloat(fields.G);
                                const PG = parseFloat(fields.PG);

                                var total = 1;
                                var n = 0;

                                while (n < PG) {
                                    total -= combinacao(P, n)*Math.pow(G, n)*Math.pow(1-G, P-n);
                                    n++;
                                }

                                return "$P(X >= k) = " + (total) + "$";
                            },
                            formula: "P(P|I) = \\frac{P(I \\cap P)}{P(I \\cap P) + P(I \\cap \\bar{P})}"
                        },
                        {
                            title: "2.",
                            fields: {
                                P: "P(P)",
                                M: "P(M)",
                                PsM: "P(P|M)",
                                XmN: "P(X>N)"
                            },
                            calculate: (fields) => {
                                const P = parseFloat(fields.P);
                                const M = parseFloat(fields.M);
                                const PsM = parseFloat(fields.PsM);
                                const XmN = parseFloat(fields.XmN);
                                const PeM = M*PsM;
                                const nMeP = P-PeM;

                                return "$P(\\bar{M} \\cap P) = " + (Math.pow(1-nMeP,XmN)) + "$";
                            },
                            formula: "P(A) = P(S) \\cdot P(A|S) + P(A|\\bar{S}) \\cdot (1-P(S))"
                        },
                        {
                            title: "3.",
                            fields: {
                                P0: "P0",
                                P3: "Pn",
                            },
                            calculate: (fields) => {
                                const P0 = parseFloat(fields.P0);
                                const k = parseFloat(fields.P3);

                                const lambda = -Math.log(P0);

                                const P3 = poissonProbability(lambda, k);

                                const P3_given_at_least_1 = P3 / (1 - P0);
                                return "$P(R|A) = " + (P3_given_at_least_1) + "$";

                            },
                            formula: "P(R|A) = \\frac{P(R) - P(\\bar{A}|R) \\cdot P(R)}{(P(R) - P(\\bar{A}|R) \\cdot P(R)) + ((1-P(R)) - P(\\bar{A}|\\bar{R}) \\cdot (1-P(R)))}"
                        },
                        {
                            title: "4.",
                            fields: {
                                EX: "E(X)",
                                sigma: "\\sigma",
                                B: "E(B...)",
                                A: "E(... + A \\sqrt{X})",
                            },
                            calculate: (fields) => {
                                const E_X = parseFloat(fields.EX);
                                const B = parseFloat(fields.B);
                                const A = parseFloat(fields.A);
                                const sigma = parseFloat(fields.sigma);

                                const b_minus_a = sigma * Math.sqrt(12);
                                const a = E_X - b_minus_a / 2;
                                const b = E_X + b_minus_a / 2;
                                const integral = (2 / 3) * (Math.pow(b, 1.5) - Math.pow(a, 1.5));
                                const E_sqrtX = integral / (b - a);

                                const custoEsperado = B + A * E_sqrtX;

                                return "$P(A|(A \\cup B)) = " + (custoEsperado) + "$";
                            },
                            formula: "P(A|(A \\cup B)) = \\frac{P(A)}{P(A) + P(B) - P(A) \\cdot P(B)}"
                        },
                        {
                            title: "5.",
                            fields: {
                                mu: "E(X)",
                                sigma: "\\sigma",
                                T: "H"
                            },
                            calculate: (fields) => {
                                const mu = parseFloat(fields.mu);      
                                const sigma = parseFloat(fields.sigma);
                                const T = parseFloat(fields.T);      

                                const z = (T - mu) / sigma;
                                const probabilidade = normCDF(z);

                                return "$P(X < T) = " + probabilidade + "$";
                            },
                            formula: "P(X < T) = \\Phi\\left(\\frac{T - \\mu}{\\sigma}\\right)"
                        }
                    ]
                },
                {
                    name: "Week 3",
                    questions: [
                        {
                            title: "1.",
                            fields: {
                                X0Y0: "P(X=0,Y=0)",
                                X0Y1: "P(X=0,Y=1)",
                                X0Y2: "P(X=0,Y=2)",
                                X1Y0: "P(X=1,Y=0)",
                                X1Y1: "P(X=1,Y=1)",
                                X1Y2: "P(X=1,Y=2)",
                                X2Y0: "P(X=2,Y=0)",
                                X2Y1: "P(X=2,Y=1)",
                                X2Y2: "P(X=2,Y=2)",
                                P: "Y"
                            },
                            calculate: (fields) => {
                                return "0";
                            },
                        },
                        {
                            title: "2.",
                            fields: {
                                Xm2Y0: "P(X=-2,Y=0)",
                                Xm2Y3: "P(X-2,Y=3)",
                                X0Y0: "P(X=0,Y=0)",
                                X0Y3: "P(X=0,Y=3)",
                                X2Y0: "P(X=2,Y=0)",
                                X2Y3: "P(X=2,Y=3)",
                                X4Y0: "P(X=4,Y=0)",
                                X4Y3: "P(X=4,Y=3)",
                                E: "E(Y|X<=N)"
                            },
                            calculate: (fields) => {
                                const matrix = {};

                                const values = [
                                    { x: -2, y: 0, val: parseFloat(fields.Xm2Y0) },
                                    { x: -2, y: 3, val: parseFloat(fields.Xm2Y3) },
                                    { x: 0,  y: 0, val: parseFloat(fields.X0Y0) },
                                    { x: 0,  y: 3, val: parseFloat(fields.X0Y3) },
                                    { x: 2,  y: 0, val: parseFloat(fields.X2Y0) },
                                    { x: 2,  y: 3, val: parseFloat(fields.X2Y3) },
                                    { x: 4,  y: 0, val: parseFloat(fields.X4Y0) },
                                    { x: 4,  y: 3, val: parseFloat(fields.X4Y3) },
                                ];

                                for (const { x, y, val } of values) {
                                    if (!matrix[x]) matrix[x] = {};
                                    matrix[x][y] = val;
                                }

                                const N = parseFloat(fields.E);

                                let num = 0;
                                let denom = 0;

                                for (const xStr in matrix) {
                                    const x = parseFloat(xStr);
                                    if (x <= N) {
                                        for (const yStr in matrix[x]) {
                                            const y = parseFloat(yStr);
                                            const prob = matrix[x][y];
                                            num += y * prob;
                                            denom += prob;
                                        }
                                    }
                                }

                                const result = denom === 0 ? 0 : num / denom;

                                return "$E(Y|X<="+N+") = " + result + "$";
                            },
                        },
                        {
                            title: "3.",
                            fields: {
                                X56Y52: "P(X=56,Y=52)",
                                X56Y54: "P(X=56,Y=54)",
                                X56Y55: "P(X=56,Y=55)",
                                X58Y52: "P(X=58,Y=52)",
                                X58Y54: "P(X=58,Y=54)",
                                X58Y55: "P(X=58,Y=55)",
                                X60Y52: "P(X=60,Y=52)",
                                X60Y54: "P(X=60,Y=54)",
                                X60Y55: "P(X=60,Y=55)",
                                P: "Y",
                            },
                            calculate: (fields) => {
                                console.log("Fields:", fields);
                                
                                const Y = parseFloat(fields.P); 

                                const matrix = {};
                                const values = [
                                    { x: 56, y: 52, val: parseFloat(fields.X56Y52) },
                                    { x: 56, y: 54, val: parseFloat(fields.X56Y54) },
                                    { x: 56, y: 55, val: parseFloat(fields.X56Y55) },
                                    { x: 58, y: 52, val: parseFloat(fields.X58Y52) },
                                    { x: 58, y: 54, val: parseFloat(fields.X58Y54) },
                                    { x: 58, y: 55, val: parseFloat(fields.X58Y55) },
                                    { x: 60, y: 52, val: parseFloat(fields.X60Y52) },
                                    { x: 60, y: 54, val: parseFloat(fields.X60Y54) },
                                    { x: 60, y: 55, val: parseFloat(fields.X60Y55) },
                                ];
                                
                                for (const { x, y, val } of values) {
                                    if (!matrix[x]) matrix[x] = {};
                                    matrix[x][y] = val;
                                }
                                
                                let pY = 0;
                                for (const x of [56, 58, 60]) {
                                    const pXY = matrix[x]?.[Y];
                                    if (pXY) pY += pXY;
                                }
                                
                                let expected = 0;
                                for (const x of [56, 58, 60]) {
                                    const pXY = matrix[x]?.[Y] || 0;
                                    const pCond = pY > 0 ? pXY / pY : 0;
                                    expected += (x + Y) * pCond;
                                }
                                
                                return "E[X+Y | Y=" + Y + "] = " + expected.toFixed(4);
                            },
                        },
                        {
                            title: "4.",
                            fields: {
                                P: "p",
                                D: "Deformação",
                                Turno1: "Turno 1",
                                Turno2: "Turno 2",
                                Turno3: "Turno 3",
                            },
                            calculate: (fields) => {
                                const P = parseFloat(fields.P);
                                const D = parseFloat(fields.D);

                                const Turno1 = parseFloat(fields.Turno1);
                                const Turno2 = parseFloat(fields.Turno2);
                                const Turno3 = parseFloat(fields.Turno3);

                                const total = Turno1 + Turno2 + Turno3;

                                return "$P(X=2) = " + combinacao(total,D)*Math.pow(P, D)*Math.pow(1-P, total-D) + "$";
                            },
                        },
                        {
                            title: "5.",
                            fields: {
                                A: "a",
                                T: "Total Reparação",
                                LInf: "LimInferior",
                                LSup: "LimSuperior",
                            },
                            calculate: (fields) => {
                                const a = parseFloat(fields.A);
                                const T = parseFloat(fields.T);
                                const LInf = parseFloat(fields.LInf);
                                const LSup = parseFloat(fields.LSup);
                                
                                const EX = 2/a;
                                const EX2 = 24/(a**2);
                                
                                const VarX = EX2 - (EX**2);
                                
                                const mean = T * EX;
                                const stdDev = Math.sqrt(T * VarX);
                                
                                const zInf = (LInf - mean) / stdDev;
                                const zSup = (LSup - mean) / stdDev;
                                
                                const pSup = normCDF(zSup);
                                const pInf = normCDF(zInf);
                                const probability = pSup - pInf;
                                
                                return `P(${LInf} < S_${T} ≤ ${LSup}) = ${probability}`;
                            },
                        }
                    ]
                },
            ];

            function toggleCollapse(element) {
                element.classList.toggle('collapsed');
            }

            function generateForm() {
                const weeksContainer = document.getElementById('weeks-container');
                    
                weeks.forEach((week, weekIndex) => {
                    const weekDiv = document.createElement('div');
                    weekDiv.className = 'week-container';
                    
                    const weekHeader = document.createElement('h2');
                    weekHeader.className = 'collapsible-header' + (weekIndex < weeks.length - 1 ? ' collapsed' : '');
                    weekHeader.textContent = week.name;
                    weekHeader.onclick = function() {
                        toggleCollapse(this);
                    };
                    
                    const weekContent = document.createElement('div');
                    weekContent.className = 'collapsible-content' + (weekIndex < weeks.length - 1 ? ' collapsed' : '');
                    
                    week.questions.forEach((question, questionIndex) => {
                        const questionId = `week${weekIndex}-question${questionIndex}`;
                        const questionDiv = document.createElement('div');
                        questionDiv.className = 'question-container';
                        
                        const questionHeader = document.createElement('h3');
                        questionHeader.className = 'collapsible-header';
                        questionHeader.textContent = question.title;
                        questionHeader.onclick = function() {
                            toggleCollapse(this);
                        };
                        
                        const questionContent = document.createElement('div');
                        questionContent.className = 'collapsible-content';
                                            
                        const formElement = document.createElement('form');
                        formElement.id = `form-${questionId}`;
                        formElement.onsubmit = function(e) {
                            e.preventDefault();
                            calculateQuestionResult(weekIndex, questionIndex);
                        };
                        
                        // Caso especial para o exercício 2 da semana 3
                        if (weekIndex === 2 && questionIndex === 1) { // Week 3, Question 2
                            const tableElement = document.createElement('table');
                            tableElement.innerHTML = `
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Y=0</th>
                                        <th>Y=3/4</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>X=-2</td>
                                        <td><input type="text" id="${questionId}-Xm2Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-Xm2Y3" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=0</td>
                                        <td><input type="text" id="${questionId}-X0Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X0Y3" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=2</td>
                                        <td><input type="text" id="${questionId}-X2Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X2Y3" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=4</td>
                                        <td><input type="text" id="${questionId}-X4Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X4Y3" class="math-input" required></td>
                                    </tr>
                                </tbody>
                            `;
                            formElement.appendChild(tableElement);
                            
                            const inputGroup = document.createElement('div');
                            inputGroup.className = 'input-group';
                            inputGroup.innerHTML = `
                                <label for="${questionId}-E"><span class="math">$E(Y|X<=N)$</span>:</label>
                                <input type="text" id="${questionId}-E" name="E" class="math-input" required>
                            `;
                            formElement.appendChild(inputGroup);
                        } 
                        // Caso especial para o exercício 1 da semana 3
                        else if (weekIndex === 2 && questionIndex === 0) {
                            const tableElement = document.createElement('table');
                            tableElement.innerHTML = `
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Y=0</th>
                                        <th>Y=1</th>
                                        <th>Y=2</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>X=0</td>
                                        <td><input type="text" id="${questionId}-X0Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X0Y1" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X0Y2" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=1</td>
                                        <td><input type="text" id="${questionId}-X1Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X1Y1" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X1Y2" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=2</td>
                                        <td><input type="text" id="${questionId}-X2Y0" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X2Y1" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X2Y2" class="math-input" required></td>
                                    </tr>
                                </tbody>
                            `;
                            formElement.appendChild(tableElement);
                            
                            const inputGroup = document.createElement('div');
                            inputGroup.className = 'input-group';
                            inputGroup.innerHTML = `
                                <label for="${questionId}-P"><span class="math">$Y$</span>:</label>
                                <input type="text" id="${questionId}-P" name="P" class="math-input" required>
                            `;
                            formElement.appendChild(inputGroup);
                        }
                        else if (weekIndex === 2 && questionIndex === 2) { // Semana 3, Questão 3
                            const tableElement = document.createElement('table');
                            tableElement.innerHTML = `
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Y=52</th>
                                        <th>Y=54</th>
                                        <th>Y=55</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>X=56</td>
                                        <td><input type="text" id="${questionId}-X56Y52" name="X56Y52" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X56Y54" name="X56Y54" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X56Y55" name="X56Y55" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=58</td>
                                        <td><input type="text" id="${questionId}-X58Y52" name="X58Y52" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X58Y54" name="X58Y54" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X58Y55" name="X58Y55" class="math-input" required></td>
                                    </tr>
                                    <tr>
                                        <td>X=60</td>
                                        <td><input type="text" id="${questionId}-X60Y52" name="X60Y52" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X60Y54" name="X60Y54" class="math-input" required></td>
                                        <td><input type="text" id="${questionId}-X60Y55" name="X60Y55" class="math-input" required></td>
                                    </tr>
                                </tbody>
                            `;
                            formElement.appendChild(tableElement);
                            
                            const inputGroup = document.createElement('div');
                            inputGroup.className = 'input-group';
                            inputGroup.innerHTML = `
                                <label for="${questionId}-P"><span class="math">$Y$</span>:</label>
                                <input type="text" id="${questionId}-P" name="P" class="math-input" required>
                            `;
                            formElement.appendChild(inputGroup);
                        }
                        // Caso padrão para outros exercícios
                        else {
                            for (const [fieldName, fieldLatex] of Object.entries(question.fields)) {
                                const inputId = `${questionId}-${fieldName}`;
                                const inputGroup = document.createElement('div');
                                inputGroup.className = 'input-group';
                                
                                inputGroup.innerHTML = `
                                    <label for="${inputId}"><span class="math">$${fieldLatex}$</span>:</label>
                                    <input type="text" id="${inputId}" name="${fieldName}" class="math-input" required>
                                `;
                                formElement.appendChild(inputGroup);
                            }
                        }
                        
                        const calculateButton = document.createElement('button');
                        calculateButton.type = 'submit';
                        calculateButton.className = 'calculate-btn';
                        calculateButton.innerText = 'Calculate';
                        formElement.appendChild(calculateButton);
                        
                        const resultDisplay = document.createElement('div');
                        resultDisplay.id = `result-${questionId}`;
                        resultDisplay.className = 'result-display';
                        resultDisplay.innerHTML = `
                            <div>Result: <span class="result-value" id="result-value-${questionId}"></span></div>
                        `;
                        
                        questionContent.appendChild(formElement);
                        questionContent.appendChild(resultDisplay);
                        
                        questionDiv.appendChild(questionHeader);
                        questionDiv.appendChild(questionContent);
                        
                        weekContent.appendChild(questionDiv);
                    });
                    
                    weekDiv.appendChild(weekHeader);
                    weekDiv.appendChild(weekContent);
                    
                    weeksContainer.appendChild(weekDiv);
                });
                
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }

            function calculateQuestionResult(weekIndex, questionIndex) {
                const question = weeks[weekIndex].questions[questionIndex];
                const questionId = `week${weekIndex}-question${questionIndex}`;
                const fields = {};
                
                let allFieldsFilled = true;
                for (const fieldName in question.fields) {
                    const inputId = `${questionId}-${fieldName}`;
                    const input = document.getElementById(inputId);
                    if (!input || input.value.trim() === '') {
                        allFieldsFilled = false;
                        if (input) input.focus();
                        return;
                    }
                    // Avaliar expressão matemática simples
                    try {
                        fields[fieldName] = eval(input.value.replace(/[^0-9+\-*/().]/g, ''));
                    } catch (e) {
                        alert(`Invalid math expression in ${question.fields[fieldName]}`);
                        input.focus();
                        return;
                    }
                }
                
                if (!allFieldsFilled) {
                    alert(`Please fill all fields for ${question.title}`);
                    return;
                }
                
                const result = question.calculate(fields);
                
                const resultDisplay = document.getElementById(`result-${questionId}`);
                const resultValue = document.getElementById(`result-value-${questionId}`);
                resultValue.innerHTML = result;
                resultDisplay.style.display = 'block';
                
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, resultValue]);
            }

            document.addEventListener('DOMContentLoaded', function() {
                generateForm();
            });
        </script>
    </div>
</body>
</html>