<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly PE Questions</title>
    
    <!-- Add MathJax script for LaTeX support -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                processEscapes: true
            }
        });
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
            position: relative;
            min-height: 100vh;
            padding-bottom: 60px;
            box-sizing: border-box;
        }
        .weeks {
            max-width: 800px;
            font-family: Arial, sans-serif;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
            position: relative;
            min-height: 100vh;
            box-sizing: border-box;
        }

        h1, h2, h3 {
            color: #ffffff;
            text-align: center;
        }
        .week-container {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .question-container {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #2a2a2a;
            border-radius: 5px;
            border: 1px solid #444;
        }
        .input-group {
            margin-bottom: 10px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #555;
            border-radius: 4px;
            background-color: #333;
            color: #fff;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .result-display {
            margin-top: 15px;
            padding: 10px;
            background-color: #2e3b2f;
            border-radius: 5px;
            display: none;
        }
        .result-value {
            font-weight: bold;
            color: #8bc34a;
        }
        .collapsible-header {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }
        .collapsible-header:after {
            content: "▼";
            font-size: 12px;
            margin-left: 10px;
            transition: transform 0.3s;
        }
        .collapsible-header.collapsed:after {
            content: "▶";
        }
        .collapsible-content {
            transition: max-height 0.3s ease-out;
            overflow: hidden;
            max-height: 2500px;
        }
        .collapsed + .collapsible-content {
            max-height: 0;
        }
        .calculate-btn {
            background-color: #4CAF50;
        }
        .minimize-btn {
            background-color: #2e2e2e;
            margin-left: 10px;
        }
        .formula-display {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #333;
            border-radius: 5px;
        }
        .footer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            max-width: 100%;
            background-color: #1e1e1e;
            color: #e0e0e0;
            text-align: center;
            padding: 15px 0;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.3);
        }
        .footer a {
            color: #4CAF50;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .github-icon {
            font-size: 20px;
            color: #e0e0e0;
        }
    </style>
</head>
<body>
    <div class="footer">
        <i class="fab fa-github github-icon"></i>
        Made with ❤️ by <a href="https://github.com/oPeras1" target="_blank">oPeras1</a>
    </div>

    <div class="weeks">
        <h1>Weekly PE Questions</h1>
        
        <div id="weeks-container"></div>
        
        <!-- Footer -->

        <script>
            function combinacao(n, k) {
                if (k > n) return 0;
                if (k === 0 || k === n) return 1;
                if (k > n - k) k = n - k;
                let c = 1;
                for (let i = 0; i < k; i++) {
                    c *= (n - i);
                    c /= (i + 1);
                }
                return c;
            }

            function poissonProbability(lambda, k) {
                return (Math.exp(-lambda) * Math.pow(lambda, k)) / factorial(k);
            }

            function factorial(n) {
                return n <= 1 ? 1 : n * factorial(n - 1);
            }

            function normCDF(z) {
                return 0.5 * (1 + erf(z / Math.sqrt(2)));
            }

            function erf(x) {
                const sign = (x >= 0) ? 1 : -1;
                x = Math.abs(x);
                const a1 =  0.254829592;
                const a2 = -0.284496736;
                const a3 =  1.421413741;
                const a4 = -1.453152027;
                const a5 =  1.061405429;
                const p  =  0.3275911;
                const t = 1.0 / (1.0 + p * x);
                const y = 1.0 - (((((a5 * t + a4) * t + a3) * t + a2) * t + a1) * t * Math.exp(-x * x));
                return sign * y;
            }

            const weeks = [
                {
                    name: "Week 1",
                    questions: [
                        {
                            title: "1.",
                            fields: {
                                IeP: "P(I \\cap P)",
                                IenP: "P(I \\cap \\bar{P})"
                            },
                            calculate: (fields) => {
                                const IeP = parseFloat(fields.IeP);
                                const IenP = parseFloat(fields.IenP);
                                return "$P(P|I) = " + (IeP / (IeP + IenP)) + "$";
                            },
                            formula: "P(P|I) = \\frac{P(I \\cap P)}{P(I \\cap P) + P(I \\cap \\bar{P})}"
                        },
                        {
                            title: "2.",
                            fields: {
                                S: "P(S)",
                                AsS: "P(A|S)",
                                AsnS: "P(A|\\bar{S})"
                            },
                            calculate: (fields) => {
                                const S = parseFloat(fields.S);
                                const AsS = parseFloat(fields.AsS);
                                const AsnS = parseFloat(fields.AsnS);
                                return "$P(A) = " + (S*AsS+AsnS*(1-S)) + "$";
                            },
                            formula: "P(A) = P(S) \\cdot P(A|S) + P(A|\\bar{S}) \\cdot (1-P(S))"
                        },
                        {
                            title: "3.",
                            fields: {
                                R: "P(R)",
                                nAsR: "P(\\bar{A}|R)",
                                nAsnR: "P(\\bar{A}|\\bar{R})"
                            },
                            calculate: (fields) => {
                                const R = parseFloat(fields.R);
                                const nAsR = parseFloat(fields.nAsR);
                                const nAsnR = parseFloat(fields.nAsnR);
                                return "$P(R|A) = " + ((R-nAsR*R)/((R-nAsR*R)+((1-R)-nAsnR*(1-R)))) + "$";
                            },
                            formula: "P(R|A) = \\frac{P(R) - P(\\bar{A}|R) \\cdot P(R)}{(P(R) - P(\\bar{A}|R) \\cdot P(R)) + ((1-P(R)) - P(\\bar{A}|\\bar{R}) \\cdot (1-P(R)))}"
                        },
                        {
                            title: "4.",
                            fields: {
                                A: "P(A)",
                                B: "P(B)"
                            },
                            calculate: (fields) => {
                                const A = parseFloat(fields.A);
                                const B = parseFloat(fields.B);
                                const AeB = A*B;
                                const AoB = A+B-AeB;
                                return "$P(A|(A \\cup B)) = " + (A/AoB) + "$";
                            },
                            formula: "P(A|(A \\cup B)) = \\frac{P(A)}{P(A) + P(B) - P(A) \\cdot P(B)}"
                        },
                        {
                            title: "5.",
                            fields: {
                                AsC: "P(A|C)",
                                AeB: "P(A \\cap B)",
                                BeC: "P(B \\cap C)"
                            },
                            calculate: (fields) => {
                                const AsC = parseFloat(fields.AsC);
                                const AeB = parseFloat(fields.AeB);
                                const BeC = parseFloat(fields.BeC);

                                const AeBeC = AsC*BeC
                                
                                return "$P(C|(A \\cap B)) = " + (AeBeC/AeB) + "$";
                            },
                            formula: "P(C|(A \\cap B)) = \\frac{P(A|C) \\cdot P(B \\cap C)}{P(A \\cap B)}"
                        }
                    ]
                },
                {
                    name: "Week 2",
                    questions: [
                        {
                            title: "1.",
                            fields: {
                                G: "P(G)",
                                PG: "k = Bin(|P|, P(G))",
                                P: "|P|"
                            },
                            calculate: (fields) => {
                                const P = parseFloat(fields.P);
                                const G = parseFloat(fields.G);
                                const PG = parseFloat(fields.PG);

                                var total = 1;
                                var n = 0;

                                while (n < PG) {
                                    total -= combinacao(P, n)*Math.pow(G, n)*Math.pow(1-G, P-n);
                                    n++;
                                }

                                return "$P(X >= k) = " + (total) + "$";
                            },
                            formula: "P(P|I) = \\frac{P(I \\cap P)}{P(I \\cap P) + P(I \\cap \\bar{P})}"
                        },
                        {
                            title: "2.",
                            fields: {
                                P: "P(P)",
                                M: "P(M)",
                                PsM: "P(P|M)",
                                XmN: "P(X>N)"
                            },
                            calculate: (fields) => {
                                const P = parseFloat(fields.P);
                                const M = parseFloat(fields.M);
                                const PsM = parseFloat(fields.PsM);
                                const XmN = parseFloat(fields.XmN);
                                const PeM = M*PsM;
                                const nMeP = P-PeM;

                                return "$P(\\bar{M} \\cap P) = " + (Math.pow(1-nMeP,XmN)) + "$";
                            },
                            formula: "P(A) = P(S) \\cdot P(A|S) + P(A|\\bar{S}) \\cdot (1-P(S))"
                        },
                        {
                            title: "3.",
                            fields: {
                                P0: "P0",
                                P3: "Pn",
                            },
                            calculate: (fields) => {
                                const P0 = parseFloat(fields.P0);
                                const k = parseFloat(fields.P3);

                                const lambda = -Math.log(P0);

                                const P3 = poissonProbability(lambda, k);

                                const P3_given_at_least_1 = P3 / (1 - P0);
                                return "$P(R|A) = " + (P3_given_at_least_1) + "$";

                            },
                            formula: "P(R|A) = \\frac{P(R) - P(\\bar{A}|R) \\cdot P(R)}{(P(R) - P(\\bar{A}|R) \\cdot P(R)) + ((1-P(R)) - P(\\bar{A}|\\bar{R}) \\cdot (1-P(R)))}"
                        },
                        {
                            title: "4.",
                            fields: {
                                EX: "E(X)",
                                sigma: "\\sigma",
                                B: "E(B...)",
                                A: "E(... + A \\sqrt{X})",
                            },
                            calculate: (fields) => {
                                const E_X = parseFloat(fields.EX);
                                const B = parseFloat(fields.B);
                                const A = parseFloat(fields.A);
                                const sigma = parseFloat(fields.sigma);

                                const b_minus_a = sigma * Math.sqrt(12);
                                const a = E_X - b_minus_a / 2;
                                const b = E_X + b_minus_a / 2;
                                const integral = (2 / 3) * (Math.pow(b, 1.5) - Math.pow(a, 1.5));
                                const E_sqrtX = integral / (b - a);

                                const custoEsperado = B + A * E_sqrtX;

                                return "$P(A|(A \\cup B)) = " + (custoEsperado) + "$";
                            },
                            formula: "P(A|(A \\cup B)) = \\frac{P(A)}{P(A) + P(B) - P(A) \\cdot P(B)}"
                        },
                        {
                            title: "5.",
                            fields: {
                                mu: "E(X)",
                                sigma: "\\sigma",
                                T: "H"
                            },
                            calculate: (fields) => {
                                const mu = parseFloat(fields.mu);      
                                const sigma = parseFloat(fields.sigma);
                                const T = parseFloat(fields.T);      

                                const z = (T - mu) / sigma;
                                const probabilidade = normCDF(z);

                                return "$P(X < T) = " + probabilidade + "$";
                            },
                            formula: "P(X < T) = \\Phi\\left(\\frac{T - \\mu}{\\sigma}\\right)"
                        }
                    ]
                },
            ];

            function toggleCollapse(element) {
                element.classList.toggle('collapsed');
            }

            function generateForm() {
                const weeksContainer = document.getElementById('weeks-container');
                    
                weeks.forEach((week, weekIndex) => {
                    const weekDiv = document.createElement('div');
                    weekDiv.className = 'week-container';
                    
                    const weekHeader = document.createElement('h2');
                    weekHeader.className = 'collapsible-header' + (weekIndex < weeks.length - 1 ? ' collapsed' : '');
                    weekHeader.textContent = week.name;
                    weekHeader.onclick = function() {
                        toggleCollapse(this);
                    };
                    
                    const weekContent = document.createElement('div');
                    weekContent.className = 'collapsible-content' + (weekIndex < weeks.length - 1 ? ' collapsed' : '');
                    
                    week.questions.forEach((question, questionIndex) => {
                        const questionId = `week${weekIndex}-question${questionIndex}`;
                        const questionDiv = document.createElement('div');
                        questionDiv.className = 'question-container';
                        
                        const questionHeader = document.createElement('h3');
                        questionHeader.className = 'collapsible-header';
                        questionHeader.textContent = question.title;
                        questionHeader.onclick = function() {
                            toggleCollapse(this);
                        };
                        
                        const questionContent = document.createElement('div');
                        questionContent.className = 'collapsible-content';
                                            
                        const formElement = document.createElement('form');
                        formElement.id = `form-${questionId}`;
                        formElement.onsubmit = function(e) {
                            e.preventDefault();
                            calculateQuestionResult(weekIndex, questionIndex);
                        };
                        
                        for (const [fieldName, fieldLatex] of Object.entries(question.fields)) {
                            const inputId = `${questionId}-${fieldName}`;
                            const inputGroup = document.createElement('div');
                            inputGroup.className = 'input-group';
                            
                            inputGroup.innerHTML = `
                                <label for="${inputId}"><span class="math">$${fieldLatex}$</span>:</label>
                                <input type="number" id="${inputId}" name="${fieldName}" step="any" required>
                            `;
                            formElement.appendChild(inputGroup);
                        }
                        
                        const calculateButton = document.createElement('button');
                        calculateButton.type = 'submit';
                        calculateButton.className = 'calculate-btn';
                        calculateButton.innerText = 'Calculate';
                        formElement.appendChild(calculateButton);
                        
                        const resultDisplay = document.createElement('div');
                        resultDisplay.id = `result-${questionId}`;
                        resultDisplay.className = 'result-display';
                        resultDisplay.innerHTML = `
                            <div>Result: <span class="result-value" id="result-value-${questionId}"></span></div>
                        `;
                        
                        questionContent.appendChild(formElement);
                        questionContent.appendChild(resultDisplay);
                        
                        questionDiv.appendChild(questionHeader);
                        questionDiv.appendChild(questionContent);
                        
                        weekContent.appendChild(questionDiv);
                    });
                    
                    weekDiv.appendChild(weekHeader);
                    weekDiv.appendChild(weekContent);
                    
                    weeksContainer.appendChild(weekDiv);
                });
                
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            }

            function calculateQuestionResult(weekIndex, questionIndex) {
                const question = weeks[weekIndex].questions[questionIndex];
                const questionId = `week${weekIndex}-question${questionIndex}`;
                const fields = {};
                
                let allFieldsFilled = true;
                for (const fieldName in question.fields) {
                    const inputId = `${questionId}-${fieldName}`;
                    const input = document.getElementById(inputId);
                    if (input.value.trim() === '') {
                        allFieldsFilled = false;
                        input.focus();
                        return;
                    }
                    fields[fieldName] = input.value;
                }
                
                if (!allFieldsFilled) {
                    alert(`Please fill all fields for ${question.title}`);
                    return;
                }
                
                const result = question.calculate(fields);
                
                const resultDisplay = document.getElementById(`result-${questionId}`);
                const resultValue = document.getElementById(`result-value-${questionId}`);
                resultValue.innerHTML = result;
                resultDisplay.style.display = 'block';
                
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, resultValue]);
            }

            document.addEventListener('DOMContentLoaded', function() {
                generateForm();
            });
        </script>
    </div>
</body>
</html>